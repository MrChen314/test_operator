root@tjzj-inf-sci-k8s-bzz2-0203:/home/users/chenquanlin/workspace/operator/test_operator/unit_tests/dq_2sm_mma# python test_dq_2sm_mma.py 
CUDA Device: CF-NG-BZZ2-O
CUDA Capability: (10, 0)
[DBG][B0 CTA0 WG0] enter idx0..3=(37,121,46,147)
[DBG][B1 CTA1 WG0] enter idx0..3=(37,121,46,147)
[DBG][B1 CTA1 WG0] ds smem(0,0..3)=(1.132812,-0.632812,-0.914062,0.388672) gmem(row=64,0..3)=(1.132812,-0.632812,-0.914062,0.388672)
[DBG][B0 CTA0 WG0] ds smem(0,0..3)=(0.194336,2.156250,-0.171875,0.847656) gmem(row=0,0..3)=(0.194336,2.156250,-0.171875,0.847656)
[DBG][B0 CTA0 WG0] part0 k_smem(k0..3,col0)=(-0.667969,-1.218750,0.259766,-0.320312) kv_ref(idx0..3,col0)=(-0.667969,0.519531,-1.132812,0.341797)
[DBG][B0 CTA0 WG0] part0 smem4x4 r0=(-0.667969,-1.218750,0.259766,-0.320312) r1=(0.519531,-0.244141,-1.726562,1.031250)
[DBG][B0 CTA0 WG0] part0 kv4x4 i0=(-0.667969,-1.218750,0.259766,-0.320312) i1=(0.519531,-0.244141,-1.726562,1.031250)
[DBG][B0 CTA0 WG0] part1 k_smem(k0..3,col0)=(0.326172,1.031250,-0.458984,0.683594) kv_ref(idx0..3,col256)=(0.326172,-0.902344,-0.839844,-1.539062)
[DBG][B0 CTA0 WG0] part1 smem4x4 r0=(0.326172,1.031250,-0.458984,0.683594) r1=(-0.902344,-0.237305,0.419922,0.359375)
[DBG][B0 CTA0 WG0] part1 kv4x4 i0=(0.326172,1.031250,-0.458984,0.683594) i1=(-0.902344,-0.237305,0.419922,0.359375)
[DBG][B0 CTA0 WG0] part2 k_smem(k0..3,col0)=(0.878906,-0.718750,-0.447266,2.015625) kv_ref(idx0..3,col512)=(0.878906,0.251953,0.498047,-0.178711)
[DBG][B0 CTA0 WG0] part2 smem4x4 r0=(0.878906,-0.718750,-0.447266,2.015625) r1=(0.251953,-1.492188,0.960938,-0.231445)
[DBG][B0 CTA0 WG0] part2 kv4x4 i0=(0.878906,-0.718750,-0.447266,2.015625) i1=(0.251953,-1.492188,0.960938,-0.231445)
[DBG][B0 CTA0 WG0] dot_pre row0 col0/256/512 smem=(3.854387,-3.333056,-1.637658) gmem=(2.300855,16.040379,-4.947721)
[DBG][B0 CTA0 WG0] dQ row0 col0/256/512 out=(3.854387,-3.333056,-1.637658) ref=(2.300855,16.040379,-4.947721)
[DBG][B1 CTA1 WG0] dQ row64 col0/256/512 out=(6.488100,10.619588,0.481457) ref=(7.053150,2.161957,4.073471)
[random] max_diff=4.713399e+01, rel_diff=3.116412e+04
[random] seg0(0:256) max=4.658333e+01 rel=3.136172e+04 | seg1(256:512) max=4.713399e+01 rel=3.187284e+04 | seg2(512:576) max=3.653772e+01 rel=2.753883e+04
[random] indices[0:8]=[37, 121, 46, 147, 116, 146, 248, 110]
[random] row0 cuda=[3.8543872833251953, 13.693556785583496, -11.645096778869629, 3.8563735485076904, -3.3330564498901367, 6.920481204986572, -1.6376579999923706, -7.3434834480285645]
[random] row0 ref =[2.3008551597595215, 15.229240417480469, -6.544325828552246, -4.444353103637695, 16.040376663208008, -2.321190357208252, -4.947720527648926, 0.018439292907714844]
[random] row64 cuda=[6.488100051879883, 8.925131797790527, 3.102323055267334, -3.3178470134735107, 10.619587898254395, -12.075927734375, 0.481456995010376, 3.8120577335357666]
[random] row64 ref =[7.053149700164795, -3.4846296310424805, -0.9503731727600098, 5.610315799713135, 2.161957263946533, 5.150981426239014, 4.073470115661621, -6.133552551269531]
[random] worst_rows=[103, 121, 89, 18] row_max_diff=[47.13399124145508, 46.58333206176758, 45.68628692626953, 45.195457458496094]
[DBG][B0 CTA0 WG0] enter idx0..3=(68,27,182,85)
[DBG][B1 CTA1 WG0] enter idx0..3=(68,27,182,85)
[DBG][B1 CTA1 WG0] ds smem(0,0..3)=(0.369141,0.433594,-0.453125,0.648438) gmem(row=64,0..3)=(0.369141,0.433594,-0.453125,0.648438)
[DBG][B0 CTA0 WG0] ds smem(0,0..3)=(-0.699219,-1.867188,-0.882812,-1.664062) gmem(row=0,0..3)=(-0.699219,-1.867188,-0.882812,-1.664062)
[DBG][B0 CTA0 WG0] part0 k_smem(k0..3,col0)=(0.679688,0.679688,0.683594,0.683594) kv_ref(idx0..3,col0)=(0.679688,0.269531,1.820312,0.851562)
[DBG][B0 CTA0 WG0] part0 smem4x4 r0=(0.679688,0.679688,0.683594,0.683594) r1=(0.269531,0.271484,0.271484,0.273438)
[DBG][B0 CTA0 WG0] part0 kv4x4 i0=(0.679688,0.679688,0.683594,0.683594) i1=(0.269531,0.271484,0.271484,0.273438)
[DBG][B0 CTA0 WG0] part1 k_smem(k0..3,col0)=(0.937500,0.937500,0.937500,0.937500) kv_ref(idx0..3,col256)=(0.937500,0.527344,2.078125,1.109375)
[DBG][B0 CTA0 WG0] part1 smem4x4 r0=(0.937500,0.937500,0.937500,0.937500) r1=(0.527344,0.527344,0.527344,0.527344)
[DBG][B0 CTA0 WG0] part1 kv4x4 i0=(0.937500,0.937500,0.937500,0.937500) i1=(0.527344,0.527344,0.527344,0.527344)
[DBG][B0 CTA0 WG0] part2 k_smem(k0..3,col0)=(1.195312,1.195312,1.195312,1.195312) kv_ref(idx0..3,col512)=(1.195312,0.781250,2.328125,1.359375)
[DBG][B0 CTA0 WG0] part2 smem4x4 r0=(1.195312,1.195312,1.195312,1.195312) r1=(0.781250,0.781250,0.785156,0.785156)
[DBG][B0 CTA0 WG0] part2 kv4x4 i0=(1.195312,1.195312,1.195312,1.195312) i1=(0.781250,0.781250,0.785156,0.785156)
[DBG][B0 CTA0 WG0] dot_pre row0 col0/256/512 smem=(2.238398,3.007390,-0.640974) gmem=(0.860570,1.578049,2.396482)
[DBG][B0 CTA0 WG0] dQ row0 col0/256/512 out=(2.238398,3.007390,-0.640974) ref=(0.860570,1.578049,2.396482)
[DBG][B1 CTA1 WG0] dQ row64 col0/256/512 out=(-2.591062,-3.472657,-5.278760) ref=(-13.819635,-14.746475,-15.661289)
[structured_kv] max_diff=5.327113e+01, rel_diff=2.650624e+04
[structured_kv] seg0(0:256) max=5.079879e+01 rel=2.715499e+04 | seg1(256:512) max=5.327113e+01 rel=3.247845e+04 | seg2(512:576) max=3.887623e+01 rel=2.239513e+01
[structured_kv] indices[0:8]=[68, 27, 182, 85, 62, 158, 228, 254]
[structured_kv] row0 cuda=[2.2383975982666016, 1.0399925708770752, 5.634727478027344, 2.757657527923584, 3.007389783859253, 1.8019819259643555, -0.640973687171936, -0.3724764585494995]
[structured_kv] row0 ref =[0.860569953918457, 0.8280389308929443, 0.8279087543487549, 0.8312091827392578, 1.5780494213104248, 1.5870335102081299, 2.396482467651367, 2.386045455932617]
[structured_kv] row64 cuda=[-2.591061592102051, -1.0715618133544922, -6.70493221282959, -3.1652650833129883, -3.4726572036743164, -1.982346534729004, -5.2787604331970215, -3.734137535095215]
[structured_kv] row64 ref =[-13.819635391235352, -13.82568073272705, -13.839845657348633, -13.819172859191895, -14.74647331237793, -14.764707565307617, -15.66128921508789, -15.701948165893555]
[structured_kv] worst_rows=[69, 89, 125, 8] row_max_diff=[53.27112579345703, 42.681007385253906, 40.42992401123047, 40.039390563964844]
Final: FAIL